generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum UserType {
  OWNER // ì†Œìƒê³µì¸
  DRIVER // ë°°ì†¡ê¸°ì‚¬
}

enum DeliveryStatus {
  PENDING // ìˆ˜ê±° ì „
  IN_PROGRESS // ë°°ì†¡ ì¤‘
  COMPLETED // ë°°ì†¡ ì™„ë£Œ
}

enum DocumentType {
  LICENSE // ìš´ì†¡ ìê²©ì¦
  CAREER // ê²½ë ¥ ì¦ëª…ì„œ
}

enum PointTransactionType {
  CHARGE  // ì¶©ì „
  USE     // ì‚¬ìš©
}

model User {
  // ğŸ§ ê³µí†µ í•„ë“œ
  id         Int      @id @default(autoincrement()) // MySQL ê³ ìœ  ID
  email      String   @unique // ë¡œê·¸ì¸ìš© ì´ë©”ì¼ (ì¤‘ë³µ ë¶ˆê°€)
  password   String // í•´ì‹±ëœ ë¹„ë°€ë²ˆí˜¸
  name       String // ì‚¬ìš©ì ì´ë¦„
  userType   UserType // ì‚¬ìš©ì ìœ í˜• (OWNER | DRIVER)
  isApproved Boolean  @default(false) // ê´€ë¦¬ìì˜ ìŠ¹ì¸ ì—¬ë¶€
  createdAt  DateTime @default(now()) // ìƒì„± ì‹œê°
  

  // ì†Œìƒê³µì¸(OWNER) ì „ìš©
  storeInfo          StoreInfo?
  subscriptionPlan   SubscriptionPlan?  @relation(fields: [subscriptionPlanId], references: [id]) // ì„ íƒí•œ êµ¬ë…ì œ
  subscriptionPlanId Int? // êµ¬ë…ì œ ID
  ownedParcels       Parcel[]           @relation("OwnerDetails") // ì†Œìƒê³µì¸ì´ ë³´ë‚¸ ì†Œí¬ë“¤
  points             PointTransaction[] // í¬ì¸íŠ¸ ì¶©ì „ ë° ì‚¬ìš© ë‚´ì—­
  defaultPickupDate String? // ì‚¬ìš©ìê°€ ì²˜ìŒ ì„¤ì •í•œ ìˆ˜ê±° í¬ë§ ìš”ì¼ (ex: "ì›”", "ìˆ˜")

  // ë°°ì†¡ê¸°ì‚¬(DRIVER) ì „ìš©
  driverInfo       DriverInfo?
  deliveredParcels Parcel[]         @relation("DriverDetails") // ê¸°ì‚¬ì—ê²Œ ë°°ì •ëœ ì†Œí¬ë“¤
  documents        DocumentUpload[] // ìê²©ì¦/ê²½ë ¥ ë“± ì œì¶œëœ ì„œë¥˜ë“¤
}

model StoreInfo {
  id               Int      @id @default(autoincrement()) // ê³ ìœ  ID
  user             User     @relation(fields: [userId], references: [id]) // ì†Œìœ í•œ ì‚¬ìš©ì (OWNER)
  userId           Int      @unique // ì—°ê²°ëœ ìœ ì € ID
  address          String // ë„ë¡œëª…/ì§€ë²ˆ ì£¼ì†Œ (ì¹´ì¹´ì˜¤ APIì—ì„œ ê°€ì ¸ì˜¨ ì£¼ì†Œ)
  detailAddress    String // ì‚¬ìš©ì ì…ë ¥ ìƒì„¸ ì£¼ì†Œ (4ì¸µ 402í˜¸ ë“±)
  expectedSize     String // ì˜ˆìƒ íƒë°° í¬ê¸° (ì†Œí˜•/ì¤‘í˜•/ëŒ€í˜• ë“±)
  monthlyCount     Int // ì›” í‰ê·  íƒë°° ìˆ˜ëŸ‰
  latitude       Float?  // ì§€ë„ìš© ìœ„ë„
  longitude      Float?  // ì§€ë„ìš© ê²½ë„
  pickupPreference String  // ìˆ˜ê±° í¬ë§ ìš”ì¼ (ex: ì›”, ìˆ˜) â†’ ë°°ì—´ ì œê±° (MySQLì€ ê¸°ë³¸ì ìœ¼ë¡œ ë°°ì—´ ì§€ì› X)
}

model DriverInfo {
  id             Int    @id @default(autoincrement()) // ê³ ìœ  ID
  user           User   @relation(fields: [userId], references: [id]) // ì—°ê²°ëœ ë°°ì†¡ê¸°ì‚¬ ìœ ì €
  userId         Int    @unique // ìœ ì € ID
  phoneNumber   String  // ê¸°ì‚¬ ì „í™”ë²ˆí˜¸
  vehicleNumber String  // ê¸°ì‚¬ ì°¨ëŸ‰ë²ˆí˜¸
  regionCity     String // ë‹´ë‹¹ ì‹œ (ì„œìš¸ì‹œ ë“±)
  regionDistrict String // ë‹´ë‹¹ êµ¬ (ê°•ë‚¨êµ¬ ë“±)
}

model DocumentUpload {
  id         Int          @id @default(autoincrement()) // ê³ ìœ  ID
  user       User         @relation(fields: [userId], references: [id]) // ì—…ë¡œë“œí•œ ì‚¬ìš©ì
  userId     Int // ìœ ì € ID
  type       DocumentType // ì„œë¥˜ ì¢…ë¥˜ (LICENSE, CAREER)
  fileUrl    String // S3 ë“± ì™¸ë¶€ íŒŒì¼ URL
  uploadedAt DateTime     @default(now()) // ì—…ë¡œë“œ ì‹œê°
}

model PointTransaction {
  id        Int      @id @default(autoincrement()) // ê³ ìœ  ID
  user      User     @relation(fields: [userId], references: [id]) // ëŒ€ìƒ ì‚¬ìš©ì
  userId    Int // ìœ ì € ID
  amount    Int // í¬ì¸íŠ¸ ë³€í™”ëŸ‰ (+ì¶©ì „, -ì‚¬ìš©)
  type PointTransactionType // ì¶©ì „ or ì‚¬ìš© ì—¬ë¶€
  reason    String // ì‚¬ìœ  ë˜ëŠ” ì„¤ëª…
  createdAt DateTime @default(now()) // ìƒì„± ì‹œê°
  expiredAt DateTime? // ì†Œë©¸ ì •ì±… ì ìš© ì‹œ ì°¸ê³ ìš©
}

model SubscriptionPlan {
  id        Int     @id @default(autoincrement()) // ê³ ìœ  ID
  name      String  @unique // êµ¬ë…ì œ ì´ë¦„ (ë² ì´ì§, í”„ë¦¬ë¯¸ì—„ ë“±)
  price     Int // ìš”ê¸ˆ (ì •ì•¡ì œ)
  createdAt DateTime @default(now()) // ë“±ë¡ ì‹œê°
  users     User[] // ì´ ìš”ê¸ˆì œë¥¼ ì‚¬ìš©í•˜ëŠ” ìœ ì €ë“¤
}

model Parcel {
  id               Int             @id @default(autoincrement()) // ê³ ìœ  ID
  owner            User            @relation("OwnerDetails", fields: [ownerId], references: [id]) // ë°œì†¡ì (OWNER)
  ownerId          Int // ë°œì†¡ì ìœ ì € ID
  driver           User?           @relation("DriverDetails", fields: [driverId], references: [id]) // ë°°ì†¡ ê¸°ì‚¬
  driverId         Int?

  productName      String // ì œí’ˆëª… (ë‚˜ì´í‚¤ ìš´ë™í™” ë“±)
  size             String // íƒë°° í¬ê¸° (ì†Œ/ì¤‘/ëŒ€/íŠ¹ëŒ€ ë“±)
  caution          Boolean @default(false) // íŒŒì†ì£¼ì˜ ì—¬ë¶€
  recipientName    String // ìˆ˜ë ¹ì¸ ì´ë¦„
  recipientPhone   String // ìˆ˜ë ¹ì¸ ì „í™”ë²ˆí˜¸
  recipientAddr    String // ìˆ˜ë ¹ì¸ ì£¼ì†Œ
  detailAddress    String? // ìˆ˜ë ¹ì¸ ìƒì„¸ ì£¼ì†Œ
  trackingCode     String? @unique // ìš´ì†¡ì¥ ë²ˆí˜¸ (ê³ ìœ ) â€” ìƒì„± ì‹œì—ëŠ” ì—†ì–´ë„ ë¨

  status           DeliveryStatus  @default(PENDING) // ë°°ì†¡ ìƒíƒœ (PENDING, IN_PROGRESS, COMPLETED)
  pickupDate DateTime? // ì‹¤ì œ ìˆ˜ê±° ì˜ˆì •ì¼ (ì„ íƒì  í•„ë“œ)
  completedAt      DateTime? // ë°°ì†¡ ì™„ë£Œ ì‹œê°
  deliveryImageUrl String          @default("") // ì¸ì¦ ì‚¬ì§„ S3 URL
  createdAt  DateTime @default(now()) // ì†Œí¬ ë“±ë¡ ì‹œê°
}
